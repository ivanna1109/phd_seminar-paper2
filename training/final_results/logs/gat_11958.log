GAT Multi Training (Graphs + Global Features)..............................................

--- Počinjem učitavanje TF Datasetova iz '/home/ivanam/BIO-Info/bio_info/multi_seminar2/datasets/tfrecords_full' ---
Učitavam datasete: Uključene Globalne Karakteristike (Dim: 2)
Svi datasetovi uspešno učitani.

--- Učitavanje TF Datasetova završeno ---
Veličina trening skupa: 2263
--------------------------------------------------------
Veličina validacionog skupa: 755
--------------------------------------------------------
Veličina test skupa: 755
--------------------------------------------------------

--- Konvertovanje trening skupa ---
Pretvaranje TF Dataset-a u Spektral Graph objekte i One-Hot enkodiranje labela za 3 klase...

--- Detalji Grafa (33dimethylbenzidinedihydrochloride_aug_perm1) ---
Dimenzija Matrice Karakteristika Čvorova (X.shape): (18, 12)
Broj Čvorova: 18
Broj Karakteristika Čvorova: 12
Dimenzija Matrice Susedstva (A.shape): (18, 18)
Broj Ivica (A.nnz): 34
Dimenzija Globalnih Karakteristika (U.shape): (2,)
Globalne Karakteristike (prve 5, ako ih ima): [284.08472  69.33474]
Labela (Y): [0. 0. 1.]
---------------------------------
Automatski određujemo num_features: 12

--- Konvertovanje validacionog skupa ---
Pretvaranje TF Dataset-a u Spektral Graph objekte i One-Hot enkodiranje labela za 3 klase...

--- Detalji Grafa (quinoline) ---
Dimenzija Matrice Karakteristika Čvorova (X.shape): (10, 12)
Broj Čvorova: 10
Broj Karakteristika Čvorova: 12
Dimenzija Matrice Susedstva (A.shape): (10, 10)
Broj Ivica (A.nnz): 22
Dimenzija Globalnih Karakteristika (U.shape): (2,)
Globalne Karakteristike (prve 5, ako ih ima): [129.05785   0.     ]
Labela (Y): [1. 0. 0.]
---------------------------------

--- Konvertovanje test skupa ---
Pretvaranje TF Dataset-a u Spektral Graph objekte i One-Hot enkodiranje labela za 3 klase...

--- Detalji Grafa (benzobfluoranthene) ---
Dimenzija Matrice Karakteristika Čvorova (X.shape): (20, 12)
Broj Čvorova: 20
Broj Karakteristika Čvorova: 12
Dimenzija Matrice Susedstva (A.shape): (20, 20)
Broj Ivica (A.nnz): 48
Dimenzija Globalnih Karakteristika (U.shape): (2,)
Globalne Karakteristike (prve 5, ako ih ima): [252.0939   50.49783]
Labela (Y): [0. 1. 0.]
---------------------------------

Kreiranje dataset instanci na osnovu konvertovanih podataka za Spektral..
Loaded 2263 graphs for MyDataset
Loaded 755 graphs for MyDataset
Loaded 755 graphs for MyDataset

Dimenzije finalnih datasetova:
Train dataset: 2263 grafova, labeli oblika: (2263, 3)
Validation dataset: 755 grafova, labeli oblika: (755, 3)
Test dataset: 755 grafova, labeli oblika: (755, 3)
Broj labela u train dataset: 2263
Broj grafova u train datasetu: 2263
Prelazimo na batch loadere...
(64, 98, 12)
(64, 98, 98)
(64, 3)
Dimenzije x_batch0: (64, 83, 12)
Dimenzije x_batch1: (64, 83, 83)
Dimenzije a_batch: (64, 3)
Tri skupa prilagodjena za trening, val i test kreirani da bi mogli pustiti u GAT.
Kreiran GAT model.
Dodati LR i ES i custom f1 score
Model kompajliran.
Start treninga...........................
2
Epoch 1/50
2
2
 1/71 [..............................] - ETA: 2:50 - loss: 21.9918 - accuracy: 0.4062 - f1_score: 0.2467 - roc_auc: 0.5405 - average_precision: 0.3730 2/71 [..............................] - ETA: 26s - loss: 20.7515 - accuracy: 0.4375 - f1_score: 0.3446 - roc_auc: 0.5905 - average_precision: 0.4080  3/71 [>.............................] - ETA: 30s - loss: 33.1194 - accuracy: 0.4115 - f1_score: 0.3005 - roc_auc: 0.5733 - average_precision: 0.3876 4/71 [>.............................] - ETA: 26s - loss: 32.6195 - accuracy: 0.4180 - f1_score: 0.3146 - roc_auc: 0.5740 - average_precision: 0.3939 5/71 [=>............................] - ETA: 24s - loss: 32.1198 - accuracy: 0.4250 - f1_score: 0.3111 - roc_auc: 0.5776 - average_precision: 0.3987 6/71 [=>............................] - ETA: 22s - loss: 30.4680 - accuracy: 0.4271 - f1_score: 0.3076 - roc_auc: 0.5732 - average_precision: 0.3983 7/71 [=>............................] - ETA: 21s - loss: 28.2440 - accuracy: 0.4263 - f1_score: 0.3163 - roc_auc: 0.5785 - average_precision: 0.4022 8/71 [==>...........................] - ETA: 22s - loss: 27.4473 - accuracy: 0.4121 - f1_score: 0.3101 - roc_auc: 0.5728 - average_precision: 0.3957 9/71 [==>...........................] - ETA: 21s - loss: 25.8855 - accuracy: 0.4028 - f1_score: 0.3119 - roc_auc: 0.5684 - average_precision: 0.388910/71 [===>..........................] - ETA: 22s - loss: 24.8434 - accuracy: 0.4062 - f1_score: 0.3226 - roc_auc: 0.5680 - average_precision: 0.390511/71 [===>..........................] - ETA: 21s - loss: 23.9783 - accuracy: 0.4091 - f1_score: 0.3305 - roc_auc: 0.5683 - average_precision: 0.390612/71 [====>.........................] - ETA: 21s - loss: 23.0444 - accuracy: 0.4089 - f1_score: 0.3339 - roc_auc: 0.5691 - average_precision: 0.391313/71 [====>.........................] - ETA: 20s - loss: 21.9436 - accuracy: 0.4123 - f1_score: 0.3414 - roc_auc: 0.5718 - average_precision: 0.393014/71 [====>.........................] - ETA: 20s - loss: 20.8594 - accuracy: 0.4208 - f1_score: 0.3530 - roc_auc: 0.5784 - average_precision: 0.397515/71 [=====>........................] - ETA: 19s - loss: 20.1380 - accuracy: 0.4115 - f1_score: 0.3472 - roc_auc: 0.5726 - average_precision: 0.391716/71 [=====>........................] - ETA: 18s - loss: 19.2802 - accuracy: 0.4189 - f1_score: 0.3584 - roc_auc: 0.5786 - average_precision: 0.397117/71 [======>.......................] - ETA: 18s - loss: 18.6498 - accuracy: 0.4182 - f1_score: 0.3597 - roc_auc: 0.5775 - average_precision: 0.397018/71 [======>.......................] - ETA: 18s - loss: 18.1307 - accuracy: 0.4227 - f1_score: 0.3666 - roc_auc: 0.5797 - average_precision: 0.399319/71 [=======>......................] - ETA: 17s - loss: 17.6602 - accuracy: 0.4227 - f1_score: 0.3688 - roc_auc: 0.5787 - average_precision: 0.398820/71 [=======>......................] - ETA: 17s - loss: 17.1842 - accuracy: 0.4195 - f1_score: 0.3685 - roc_auc: 0.5765 - average_precision: 0.396821/71 [=======>......................] - ETA: 16s - loss: 16.7495 - accuracy: 0.4226 - f1_score: 0.3734 - roc_auc: 0.5778 - average_precision: 0.397322/71 [========>.....................] - ETA: 16s - loss: 16.3304 - accuracy: 0.4247 - f1_score: 0.3770 - roc_auc: 0.5802 - average_precision: 0.400223/71 [========>.....................] - ETA: 15s - loss: 15.9479 - accuracy: 0.4280 - f1_score: 0.3815 - roc_auc: 0.5822 - average_precision: 0.401724/71 [=========>....................] - ETA: 15s - loss: 15.6010 - accuracy: 0.4284 - f1_score: 0.3813 - roc_auc: 0.5827 - average_precision: 0.402125/71 [=========>....................] - ETA: 15s - loss: 15.2851 - accuracy: 0.4306 - f1_score: 0.3850 - roc_auc: 0.5842 - average_precision: 0.403626/71 [=========>....................] - ETA: 14s - loss: 14.9772 - accuracy: 0.4321 - f1_score: 0.3866 - roc_auc: 0.5858 - average_precision: 0.405227/71 [==========>...................] - ETA: 14s - loss: 14.6377 - accuracy: 0.4358 - f1_score: 0.3915 - roc_auc: 0.5887 - average_precision: 0.407828/71 [==========>...................] - ETA: 13s - loss: 14.4347 - accuracy: 0.4336 - f1_score: 0.3909 - roc_auc: 0.5873 - average_precision: 0.406229/71 [===========>..................] - ETA: 13s - loss: 14.1597 - accuracy: 0.4316 - f1_score: 0.3905 - roc_auc: 0.5869 - average_precision: 0.406230/71 [===========>..................] - ETA: 13s - loss: 13.9084 - accuracy: 0.4318 - f1_score: 0.3918 - roc_auc: 0.5883 - average_precision: 0.407431/71 [============>.................] - ETA: 13s - loss: 13.7540 - accuracy: 0.4320 - f1_score: 0.3930 - roc_auc: 0.5882 - average_precision: 0.407232/71 [============>.................] - ETA: 12s - loss: 13.5434 - accuracy: 0.4365 - f1_score: 0.3988 - roc_auc: 0.5918 - average_precision: 0.410533/71 [============>.................] - ETA: 12s - loss: 13.3571 - accuracy: 0.4375 - f1_score: 0.4004 - roc_auc: 0.5934 - average_precision: 0.412134/71 [=============>................] - ETA: 11s - loss: 13.2702 - accuracy: 0.4351 - f1_score: 0.3956 - roc_auc: 0.5926 - average_precision: 0.411835/71 [=============>................] - ETA: 11s - loss: 13.0663 - accuracy: 0.4347 - f1_score: 0.3959 - roc_auc: 0.5935 - average_precision: 0.412536/71 [==============>...............] - ETA: 11s - loss: 13.1036 - accuracy: 0.4344 - f1_score: 0.3958 - roc_auc: 0.5929 - average_precision: 0.412237/71 [==============>...............] - ETA: 10s - loss: 12.9708 - accuracy: 0.4366 - f1_score: 0.3973 - roc_auc: 0.5955 - average_precision: 0.414838/71 [===============>..............] - ETA: 10s - loss: 12.8405 - accuracy: 0.4362 - f1_score: 0.3979 - roc_auc: 0.5947 - average_precision: 0.414139/71 [===============>..............] - ETA: 10s - loss: 12.6395 - accuracy: 0.4379 - f1_score: 0.4004 - roc_auc: 0.5961 - average_precision: 0.415240/71 [===============>..............] - ETA: 9s - loss: 12.4919 - accuracy: 0.4391 - f1_score: 0.4025 - roc_auc: 0.5966 - average_precision: 0.4158 41/71 [================>.............] - ETA: 9s - loss: 12.3566 - accuracy: 0.4398 - f1_score: 0.4039 - roc_auc: 0.5970 - average_precision: 0.416142/71 [================>.............] - ETA: 9s - loss: 12.2584 - accuracy: 0.4409 - f1_score: 0.4058 - roc_auc: 0.5976 - average_precision: 0.416543/71 [=================>............] - ETA: 8s - loss: 12.1089 - accuracy: 0.4412 - f1_score: 0.4070 - roc_auc: 0.5977 - average_precision: 0.416844/71 [=================>............] - ETA: 8s - loss: 11.9377 - accuracy: 0.4432 - f1_score: 0.4096 - roc_auc: 0.5998 - average_precision: 0.418645/71 [==================>...........] - ETA: 8s - loss: 11.8417 - accuracy: 0.4442 - f1_score: 0.4112 - roc_auc: 0.6011 - average_precision: 0.419846/71 [==================>...........] - ETA: 8s - loss: 11.7393 - accuracy: 0.4437 - f1_score: 0.4109 - roc_auc: 0.6007 - average_precision: 0.419547/71 [==================>...........] - ETA: 7s - loss: 11.6386 - accuracy: 0.4449 - f1_score: 0.4120 - roc_auc: 0.6019 - average_precision: 0.421148/71 [===================>..........] - ETA: 7s - loss: 11.5207 - accuracy: 0.4454 - f1_score: 0.4116 - roc_auc: 0.6027 - average_precision: 0.421949/71 [===================>..........] - ETA: 7s - loss: 11.4344 - accuracy: 0.4433 - f1_score: 0.4098 - roc_auc: 0.6021 - average_precision: 0.421350/71 [====================>.........] - ETA: 6s - loss: 11.3316 - accuracy: 0.4422 - f1_score: 0.4092 - roc_auc: 0.6013 - average_precision: 0.420551/71 [====================>.........] - ETA: 6s - loss: 11.2686 - accuracy: 0.4403 - f1_score: 0.4073 - roc_auc: 0.6006 - average_precision: 0.419752/71 [====================>.........] - ETA: 6s - loss: 11.1698 - accuracy: 0.4402 - f1_score: 0.4077 - roc_auc: 0.6002 - average_precision: 0.419153/71 [=====================>........] - ETA: 5s - loss: 11.0812 - accuracy: 0.4402 - f1_score: 0.4083 - roc_auc: 0.5999 - average_precision: 0.418754/71 [=====================>........] - ETA: 5s - loss: 10.9810 - accuracy: 0.4387 - f1_score: 0.4064 - roc_auc: 0.5994 - average_precision: 0.418355/71 [======================>.......] - ETA: 5s - loss: 10.8823 - accuracy: 0.4389 - f1_score: 0.4068 - roc_auc: 0.6001 - average_precision: 0.418956/71 [======================>.......] - ETA: 4s - loss: 10.7717 - accuracy: 0.4383 - f1_score: 0.4064 - roc_auc: 0.6002 - average_precision: 0.419057/71 [=======================>......] - ETA: 4s - loss: 10.6871 - accuracy: 0.4375 - f1_score: 0.4059 - roc_auc: 0.6003 - average_precision: 0.419058/71 [=======================>......] - ETA: 4s - loss: 10.6071 - accuracy: 0.4386 - f1_score: 0.4075 - roc_auc: 0.6007 - average_precision: 0.419459/71 [=======================>......] - ETA: 4s - loss: 10.4977 - accuracy: 0.4407 - f1_score: 0.4096 - roc_auc: 0.6026 - average_precision: 0.421560/71 [========================>.....] - ETA: 3s - loss: 10.4587 - accuracy: 0.4406 - f1_score: 0.4101 - roc_auc: 0.6025 - average_precision: 0.421561/71 [========================>.....] - ETA: 3s - loss: 10.3785 - accuracy: 0.4406 - f1_score: 0.4100 - roc_auc: 0.6023 - average_precision: 0.421162/71 [=========================>....] - ETA: 3s - loss: 10.3153 - accuracy: 0.4410 - f1_score: 0.4110 - roc_auc: 0.6028 - average_precision: 0.421663/71 [=========================>....] - ETA: 2s - loss: 10.2447 - accuracy: 0.4417 - f1_score: 0.4119 - roc_auc: 0.6035 - average_precision: 0.422464/71 [==========================>...] - ETA: 2s - loss: 10.1313 - accuracy: 0.4436 - f1_score: 0.4142 - roc_auc: 0.6053 - average_precision: 0.424065/71 [==========================>...] - ETA: 2s - loss: 10.0557 - accuracy: 0.4450 - f1_score: 0.4161 - roc_auc: 0.6066 - average_precision: 0.425366/71 [==========================>...] - ETA: 1s - loss: 9.9713 - accuracy: 0.4456 - f1_score: 0.4171 - roc_auc: 0.6077 - average_precision: 0.4260 67/71 [===========================>..] - ETA: 1s - loss: 9.8866 - accuracy: 0.4445 - f1_score: 0.4163 - roc_auc: 0.6077 - average_precision: 0.426068/71 [===========================>..] - ETA: 1s - loss: 9.8145 - accuracy: 0.4451 - f1_score: 0.4173 - roc_auc: 0.6085 - average_precision: 0.426869/71 [============================>.] - ETA: 0s - loss: 9.7310 - accuracy: 0.4464 - f1_score: 0.4189 - roc_auc: 0.6095 - average_precision: 0.427670/71 [============================>.] - ETA: 0s - loss: 9.7045 - accuracy: 0.4461 - f1_score: 0.4178 - roc_auc: 0.6092 - average_precision: 0.427371/71 [==============================] - ETA: 0s - loss: 9.6411 - accuracy: 0.4467 - f1_score: 0.4187 - roc_auc: 0.6098 - average_precision: 0.42792

Epoch 1: val_f1_score = 0.3871
71/71 [==============================] - 28s 371ms/step - loss: 9.6411 - accuracy: 0.4467 - f1_score: 0.4187 - roc_auc: 0.6098 - average_precision: 0.4279 - val_loss: 1.1644 - val_accuracy: 0.4993 - val_f1_score: 0.3871 - val_roc_auc: 0.7015 - val_average_precision: 0.5186 - lr: 7.2000e-04
Epoch 2/50
 1/71 [..............................] - ETA: 31s - loss: 6.3565 - accuracy: 0.4688 - f1_score: 0.4615 - roc_auc: 0.5849 - average_precision: 0.4289 2/71 [..............................] - ETA: 33s - loss: 5.9827 - accuracy: 0.4531 - f1_score: 0.4486 - roc_auc: 0.6234 - average_precision: 0.4493 3/71 [>.............................] - ETA: 26s - loss: 5.5925 - accuracy: 0.4740 - f1_score: 0.4709 - roc_auc: 0.6249 - average_precision: 0.4485 4/71 [>.............................] - ETA: 22s - loss: 5.4985 - accuracy: 0.4766 - f1_score: 0.4726 - roc_auc: 0.6310 - average_precision: 0.4496 5/71 [=>............................] - ETA: 24s - loss: 5.5692 - accuracy: 0.4781 - f1_score: 0.4702 - roc_auc: 0.6335 - average_precision: 0.4515 6/71 [=>............................] - ETA: 24s - loss: 5.6484 - accuracy: 0.4792 - f1_score: 0.4662 - roc_auc: 0.6340 - average_precision: 0.4509 7/71 [=>............................] - ETA: 25s - loss: 5.6942 - accuracy: 0.4821 - f1_score: 0.4700 - roc_auc: 0.6341 - average_precision: 0.4524 8/71 [==>...........................] - ETA: 27s - loss: 5.9230 - accuracy: 0.4746 - f1_score: 0.4622 - roc_auc: 0.6248 - average_precision: 0.4435 9/71 [==>...........................] - ETA: 25s - loss: 5.6540 - accuracy: 0.4740 - f1_score: 0.4630 - roc_auc: 0.6287 - average_precision: 0.446210/71 [===>..........................] - ETA: 23s - loss: 5.5698 - accuracy: 0.4797 - f1_score: 0.4652 - roc_auc: 0.6365 - average_precision: 0.455011/71 [===>..........................] - ETA: 24s - loss: 5.6878 - accuracy: 0.4759 - f1_score: 0.4583 - roc_auc: 0.6321 - average_precision: 0.452112/71 [====>.........................] - ETA: 22s - loss: 5.5481 - accuracy: 0.4740 - f1_score: 0.4576 - roc_auc: 0.6291 - average_precision: 0.448513/71 [====>.........................] - ETA: 22s - loss: 5.5100 - accuracy: 0.4820 - f1_score: 0.4644 - roc_auc: 0.6361 - average_precision: 0.456114/71 [====>.........................] - ETA: 22s - loss: 5.4635 - accuracy: 0.4821 - f1_score: 0.4655 - roc_auc: 0.6389 - average_precision: 0.458015/71 [=====>........................] - ETA: 21s - loss: 5.4321 - accuracy: 0.4844 - f1_score: 0.4677 - roc_auc: 0.6444 - average_precision: 0.463016/71 [=====>........................] - ETA: 21s - loss: 5.3813 - accuracy: 0.4863 - f1_score: 0.4703 - roc_auc: 0.6462 - average_precision: 0.464517/71 [======>.......................] - ETA: 21s - loss: 5.3100 - accuracy: 0.4908 - f1_score: 0.4752 - roc_auc: 0.6498 - average_precision: 0.470318/71 [======>.......................] - ETA: 20s - loss: 5.2575 - accuracy: 0.4905 - f1_score: 0.4743 - roc_auc: 0.6516 - average_precision: 0.472219/71 [=======>......................] - ETA: 19s - loss: 5.2736 - accuracy: 0.4860 - f1_score: 0.4701 - roc_auc: 0.6469 - average_precision: 0.467820/71 [=======>......................] - ETA: 18s - loss: 5.1982 - accuracy: 0.4891 - f1_score: 0.4719 - roc_auc: 0.6497 - average_precision: 0.471021/71 [=======>......................] - ETA: 18s - loss: 5.2198 - accuracy: 0.4874 - f1_score: 0.4689 - roc_auc: 0.6483 - average_precision: 0.468422/71 [========>.....................] - ETA: 17s - loss: 5.2064 - accuracy: 0.4879 - f1_score: 0.4684 - roc_auc: 0.6487 - average_precision: 0.469923/71 [========>.....................] - ETA: 16s - loss: 5.0863 - accuracy: 0.4918 - f1_score: 0.4727 - roc_auc: 0.6529 - average_precision: 0.474024/71 [=========>....................] - ETA: 16s - loss: 5.1015 - accuracy: 0.4909 - f1_score: 0.4725 - roc_auc: 0.6507 - average_precision: 0.4721