GCN Multi Training (Graphs Only)..............................................
GAT Multi Training (Graphs + Global Features)..............................................

--- Počinjem učitavanje TF Datasetova iz '/home/ivanam/BIO-Info/bio_info/multi_seminar2/datasets/tfrecords_full' ---
Učitavam datasete: Uključene Globalne Karakteristike (Dim: 2)
Svi datasetovi uspešno učitani.

--- Učitavanje TF Datasetova završeno ---
Veličina trening skupa: 2263
--------------------------------------------------------
Veličina validacionog skupa: 755
--------------------------------------------------------
Veličina test skupa: 755
--------------------------------------------------------

--- Konvertovanje trening skupa ---
Pretvaranje TF Dataset-a u Spektral Graph objekte i One-Hot enkodiranje labela za 3 klase...
Automatski određujemo num_features: 12

--- Konvertovanje validacionog skupa ---
Pretvaranje TF Dataset-a u Spektral Graph objekte i One-Hot enkodiranje labela za 3 klase...

--- Konvertovanje test skupa ---
Pretvaranje TF Dataset-a u Spektral Graph objekte i One-Hot enkodiranje labela za 3 klase...

Kreiranje dataset instanci na osnovu konvertovanih podataka za Spektral..
Loaded 2263 graphs for MyDataset
Loaded 755 graphs for MyDataset
Loaded 755 graphs for MyDataset

Dimenzije finalnih datasetova:
Train dataset: 2263 grafova, labeli oblika: (2263, 3)
Validation dataset: 755 grafova, labeli oblika: (755, 3)
Test dataset: 755 grafova, labeli oblika: (755, 3)
Broj labela u train dataset: 2263
Broj grafova u train datasetu: 2263
Prelazimo na batch loadere...
(64, 68, 12)
(64, 68, 68)
(64, 3)
Dimenzije x_batch0: (64, 52, 12)
Dimenzije x_batch1: (64, 52, 52)
Dimenzije a_batch: (64, 3)
Tri skupa prilagodjena za trening, val i test kreirani da bi mogli pustiti u GAT.
Kreiran GAT model.
Dodati LR i ES i custom f1 score
Model kompajliran.
Start treninga...........................
2
Epoch 1/50
2
2
 1/36 [..............................] - ETA: 1:47 - loss: 24.5853 - accuracy: 0.2344 - f1_score: 0.1683 - roc_auc: 0.4441 - average_precision: 0.2851 2/36 [>.............................] - ETA: 5s - loss: 14.9160 - accuracy: 0.3750 - f1_score: 0.3188 - roc_auc: 0.5457 - average_precision: 0.3479   3/36 [=>............................] - ETA: 6s - loss: 12.8982 - accuracy: 0.3750 - f1_score: 0.3204 - roc_auc: 0.5320 - average_precision: 0.3592 4/36 [==>...........................] - ETA: 8s - loss: 12.2959 - accuracy: 0.3828 - f1_score: 0.3371 - roc_auc: 0.5415 - average_precision: 0.3630 5/36 [===>..........................] - ETA: 8s - loss: 12.3634 - accuracy: 0.3844 - f1_score: 0.3415 - roc_auc: 0.5435 - average_precision: 0.3632 6/36 [====>.........................] - ETA: 7s - loss: 11.6271 - accuracy: 0.4010 - f1_score: 0.3584 - roc_auc: 0.5594 - average_precision: 0.3763 7/36 [====>.........................] - ETA: 6s - loss: 11.4090 - accuracy: 0.3884 - f1_score: 0.3445 - roc_auc: 0.5512 - average_precision: 0.3695 8/36 [=====>........................] - ETA: 6s - loss: 10.6804 - accuracy: 0.4043 - f1_score: 0.3567 - roc_auc: 0.5619 - average_precision: 0.3803 9/36 [======>.......................] - ETA: 5s - loss: 10.0941 - accuracy: 0.4149 - f1_score: 0.3679 - roc_auc: 0.5704 - average_precision: 0.389510/36 [=======>......................] - ETA: 5s - loss: 9.8209 - accuracy: 0.4266 - f1_score: 0.3818 - roc_auc: 0.5821 - average_precision: 0.4010 11/36 [========>.....................] - ETA: 4s - loss: 9.5887 - accuracy: 0.4276 - f1_score: 0.3866 - roc_auc: 0.5831 - average_precision: 0.401512/36 [=========>....................] - ETA: 5s - loss: 9.8896 - accuracy: 0.4271 - f1_score: 0.3842 - roc_auc: 0.5807 - average_precision: 0.399513/36 [=========>....................] - ETA: 4s - loss: 9.5352 - accuracy: 0.4303 - f1_score: 0.3901 - roc_auc: 0.5858 - average_precision: 0.403114/36 [==========>...................] - ETA: 4s - loss: 9.1653 - accuracy: 0.4286 - f1_score: 0.3897 - roc_auc: 0.5860 - average_precision: 0.402915/36 [===========>..................] - ETA: 4s - loss: 9.0049 - accuracy: 0.4219 - f1_score: 0.3837 - roc_auc: 0.5807 - average_precision: 0.398816/36 [============>.................] - ETA: 3s - loss: 8.8270 - accuracy: 0.4219 - f1_score: 0.3858 - roc_auc: 0.5794 - average_precision: 0.397917/36 [=============>................] - ETA: 3s - loss: 8.6868 - accuracy: 0.4200 - f1_score: 0.3844 - roc_auc: 0.5773 - average_precision: 0.396218/36 [==============>...............] - ETA: 3s - loss: 8.6570 - accuracy: 0.4184 - f1_score: 0.3830 - roc_auc: 0.5765 - average_precision: 0.396219/36 [==============>...............] - ETA: 3s - loss: 8.4998 - accuracy: 0.4202 - f1_score: 0.3868 - roc_auc: 0.5790 - average_precision: 0.398420/36 [===============>..............] - ETA: 3s - loss: 8.3074 - accuracy: 0.4234 - f1_score: 0.3907 - roc_auc: 0.5818 - average_precision: 0.400621/36 [================>.............] - ETA: 3s - loss: 8.3077 - accuracy: 0.4241 - f1_score: 0.3889 - roc_auc: 0.5832 - average_precision: 0.401222/36 [=================>............] - ETA: 2s - loss: 8.2227 - accuracy: 0.4212 - f1_score: 0.3853 - roc_auc: 0.5826 - average_precision: 0.400823/36 [==================>...........] - ETA: 2s - loss: 8.1342 - accuracy: 0.4226 - f1_score: 0.3856 - roc_auc: 0.5830 - average_precision: 0.400924/36 [===================>..........] - ETA: 2s - loss: 8.0220 - accuracy: 0.4238 - f1_score: 0.3883 - roc_auc: 0.5858 - average_precision: 0.403425/36 [===================>..........] - ETA: 2s - loss: 7.8456 - accuracy: 0.4269 - f1_score: 0.3928 - roc_auc: 0.5887 - average_precision: 0.405726/36 [====================>.........] - ETA: 1s - loss: 7.7130 - accuracy: 0.4273 - f1_score: 0.3949 - roc_auc: 0.5902 - average_precision: 0.407027/36 [=====================>........] - ETA: 1s - loss: 7.5870 - accuracy: 0.4282 - f1_score: 0.3962 - roc_auc: 0.5923 - average_precision: 0.408428/36 [======================>.......] - ETA: 1s - loss: 7.5210 - accuracy: 0.4258 - f1_score: 0.3942 - roc_auc: 0.5908 - average_precision: 0.406729/36 [=======================>......] - ETA: 1s - loss: 7.4437 - accuracy: 0.4267 - f1_score: 0.3950 - roc_auc: 0.5923 - average_precision: 0.408030/36 [========================>.....] - ETA: 1s - loss: 7.4046 - accuracy: 0.4313 - f1_score: 0.3984 - roc_auc: 0.5947 - average_precision: 0.410831/36 [========================>.....] - ETA: 1s - loss: 7.2838 - accuracy: 0.4345 - f1_score: 0.4027 - roc_auc: 0.5981 - average_precision: 0.414232/36 [=========================>....] - ETA: 0s - loss: 7.1926 - accuracy: 0.4375 - f1_score: 0.4068 - roc_auc: 0.6004 - average_precision: 0.416633/36 [==========================>...] - ETA: 0s - loss: 7.1542 - accuracy: 0.4389 - f1_score: 0.4074 - roc_auc: 0.6020 - average_precision: 0.418334/36 [===========================>..] - ETA: 0s - loss: 7.1007 - accuracy: 0.4398 - f1_score: 0.4104 - roc_auc: 0.6031 - average_precision: 0.419235/36 [============================>.] - ETA: 0s - loss: 7.0469 - accuracy: 0.4388 - f1_score: 0.4106 - roc_auc: 0.6022 - average_precision: 0.418336/36 [==============================] - ETA: 0s - loss: 7.0290 - accuracy: 0.4384 - f1_score: 0.4109 - roc_auc: 0.6024 - average_precision: 0.41832

Epoch 1: val_f1_score = 0.1602
36/36 [==============================] - 11s 239ms/step - loss: 7.0290 - accuracy: 0.4384 - f1_score: 0.4109 - roc_auc: 0.6024 - average_precision: 0.4183 - val_loss: 1.9905 - val_accuracy: 0.3192 - val_f1_score: 0.1602 - val_roc_auc: 0.6037 - val_average_precision: 0.3534 - lr: 7.2000e-04
Epoch 2/50
 1/36 [..............................] - ETA: 5s - loss: 3.4747 - accuracy: 0.5312 - f1_score: 0.5290 - roc_auc: 0.7142 - average_precision: 0.5167 2/36 [>.............................] - ETA: 10s - loss: 4.0143 - accuracy: 0.5391 - f1_score: 0.5296 - roc_auc: 0.7034 - average_precision: 0.5317 3/36 [=>............................] - ETA: 7s - loss: 4.1592 - accuracy: 0.5052 - f1_score: 0.4843 - roc_auc: 0.6856 - average_precision: 0.5146  4/36 [==>...........................] - ETA: 6s - loss: 4.2066 - accuracy: 0.4961 - f1_score: 0.4804 - roc_auc: 0.6597 - average_precision: 0.4857 5/36 [===>..........................] - ETA: 5s - loss: 4.0580 - accuracy: 0.5125 - f1_score: 0.4964 - roc_auc: 0.6709 - average_precision: 0.4972